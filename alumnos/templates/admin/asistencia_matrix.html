{% extends "admin/change_list.html" %}
{% block content %}
<style>
    /* Estilos para imitar el Excel de la imagen image_01b754.png */
    .excel-table { width: 100%; border-collapse: collapse; font-family: sans-serif; background: white; margin-top: 20px; font-size: 13px; }
    .excel-table th, .excel-table td { border: 1px solid #ccc; padding: 6px; text-align: center; }
    
    /* Colores para Presente (P) y Ausente (A) */
    .bg-p { background-color: #28a745 !important; color: white; font-weight: bold; }
    .bg-a { background-color: #dc3545 !important; color: white; font-weight: bold; }
    
    /* Encabezado con los colores de Boca */
    .bg-header { background-color: #003087; color: #FFD100; font-weight: bold; }
    
    /* Columnas de informaci√≥n adicional */
    .col-stats { background-color: #f1f3f4; font-weight: bold; width: 60px; border-left: 2px solid #666 !important; }
    .nombre-alumno { text-align: left !important; min-width: 250px; font-weight: 500; }
</style>

<div id="content-main">
    <h1>Control de Asistencia y Notas por Curso</h1>
    
    <div style="margin-bottom: 20px;">
        {{ block.super }}
    </div>

    <table class="excel-table">
        <thead>
            <tr class="bg-header">
                <th class="nombre-alumno">Alumnos</th>
                <th class="col-stats">% Asist.</th>
                <th class="col-stats">Prom. VAR</th>
                {% for fecha in fechas %}
                    <th>{{ fecha|date:"d/m" }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for fila in matrix %}
            <tr>
                <td class="nombre-alumno">
                    {{ fila.alumno.apellido_completo }}, {{ fila.alumno.nombre_completo }}
                </td>
                
                <td style="color: {% if fila.porcentaje < 75 %}#dc3545{% else %}#28a745{% endif %}; font-weight: bold;">
                    {{ fila.porcentaje }}%
                </td>
                
                <td style="background-color: #e8f0fe; font-weight: bold;">
                    {{ fila.promedio }}
                </td>

                {% for estado in fila.asistencias %}
                    <td class="{% if estado == 'P' %}bg-p{% elif estado == 'A' %}bg-a{% endif %}">
                        {{ estado }}
                    </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}